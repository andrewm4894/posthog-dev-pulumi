# PostHog Development VMs Configuration
# Edit this file and run `pulumi up` to apply changes

# Default settings (applied to all VMs unless overridden)
defaults:
  machine_type: e2-standard-8
  disk_size_gb: 100
  posthog_branch: master
  enable_minimal_mode: false
  os_image: "projects/${GCP_PROJECT}/global/images/posthog-dev-base"
  # Optional: extra repos to clone under /home/ph (branch omitted uses default)
  additional_repos:
    - url: "https://github.com/posthog/posthog.com.git"
    - url: "https://github.com/posthog/posthog-js.git"
    - url: "https://github.com/posthog/posthog-python.git"
    - url: "https://github.com/posthog/llm-analytics-apps.git"
  # Or set globally via Pulumi config:
  #   pulumi config set baseImage "projects/${GCP_PROJECT}/global/images/posthog-dev-base"

# Monitoring configuration
monitoring:
  # GCP Ops Agent - for Cloud Monitoring/Logging integration
  ops_agent_enabled: true

  # Netdata - for real-time monitoring dashboard
  netdata_enabled: true
  netdata_claim_url: https://app.netdata.cloud
  # IMPORTANT: Set your Netdata room via Pulumi config:
  #   pulumi config set netdataClaimRooms "YOUR_ROOM_ID"
  # OPTIONAL: Store the claim token in Secret Manager and reference it here:
  #   netdata_claim_token_secret_name: "netdata-claim-token"

# Claude Code configuration
claude_code:
  # Enable Claude Code installation on VMs
  enabled: true
  # OPTIONAL: Store the API key in Secret Manager and reference it here:
  #   secret_name: "anthropic-api-key"

# Chrome Remote Desktop configuration
remote_desktop:
  # Enable XFCE desktop + Chrome Remote Desktop
  enabled: true
  # OPTIONAL: Store the password in Secret Manager (for sudo in desktop session):
  #   password_secret_name: "rdp-password"
  # Setup: SSH to VM, run the command from https://remotedesktop.google.com/headless
  # Then connect via: https://remotedesktop.google.com/access

# OpenAI Codex CLI configuration
codex_cli:
  # Enable Codex CLI installation on VMs
  enabled: true
  # OPTIONAL: Store the API key in Secret Manager and reference it here:
  #   secret_name: "openai-api-key"

# GitHub CLI configuration
github_cli:
  # Enable GitHub CLI installation on VMs
  enabled: true
  # OPTIONAL: Store the token in Secret Manager and reference it here:
  #   secret_name: "github-token"

# VM definitions
# Uncomment and modify to create VMs
vms:
  - name: posthog-master
    description: "PostHog master branch"
    # posthog_branch: master  # uses default

  # - name: posthog-feat-llma-bool-evals-with-na
  #   description: "PostHog feature branch - LLM bool evals with NA"
  #   posthog_branch: feat/llma-bool-evals-with-na

  # Example: PR review VM
  # - name: posthog-pr-1234
  #   description: "PR #1234 review"
  #   posthog_branch: pr-1234-branch
