# PostHog Development VMs Configuration
# Edit this file and run `pulumi up` to apply changes

# Default settings (applied to all VMs unless overridden)
defaults:
  machine_type: e2-standard-8
  disk_size_gb: 100
  zone: europe-west1-b
  posthog_branch: master
  enable_minimal_mode: false

# Your allowed IPs - SET VIA PULUMI CONFIG, NOT HERE!
# Run: pulumi config set allowedIps '["YOUR.IP.HERE/32"]'
# These IPs can access PostHog ports (8010, 8000, 3000, etc.)
# SSH is always open via GCP OS Login
# allowed_ips:
#   - YOUR.IP.HERE/32

# Monitoring configuration
monitoring:
  # GCP Ops Agent - for Cloud Monitoring/Logging integration
  ops_agent_enabled: true

  # Netdata - for real-time monitoring dashboard
  netdata_enabled: true
  netdata_claim_url: https://app.netdata.cloud
  netdata_claim_rooms: c88fcf94-d115-4628-9ea7-696c647317ac
  # IMPORTANT: Store the claim token as a Pulumi secret:
  #   pulumi config set --secret netdataClaimToken "YOUR_TOKEN"

# Claude Code configuration
claude_code:
  # Enable Claude Code installation on VMs
  enabled: true
  # IMPORTANT: Store the API key as a Pulumi secret:
  #   pulumi config set --secret anthropicApiKey "YOUR_API_KEY"

# Remote Desktop (xrdp) configuration
remote_desktop:
  # Enable XFCE desktop + xrdp for RDP access
  enabled: true
  # Allow RDP access from any IP (0.0.0.0/0) instead of just allowed_ips
  # WARNING: Only enable if you have a strong password set!
  allow_all_ips: true
  # IMPORTANT: Store the password as a Pulumi secret:
  #   pulumi config set --secret rdpPassword "YourSecurePassword123"
  # Connect with any RDP client to <external-ip>:3389
  # Username: ph

# OpenAI Codex CLI configuration
codex_cli:
  # Enable Codex CLI installation on VMs
  enabled: true
  # IMPORTANT: Store the API key as a Pulumi secret:
  #   pulumi config set --secret openaiApiKey "YOUR_API_KEY"

# VM definitions
# Uncomment and modify to create VMs
vms:
  - name: posthog-master
    description: "PostHog master branch"
    # posthog_branch: master  # uses default

  # - name: posthog-feat-llma-bool-evals-with-na
  #   description: "PostHog feature branch - LLM bool evals with NA"
  #   posthog_branch: feat/llma-bool-evals-with-na

  # Example: PR review VM
  # - name: posthog-pr-1234
  #   description: "PR #1234 review"
  #   posthog_branch: pr-1234-branch
